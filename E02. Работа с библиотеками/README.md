# Использование сторонних библиотек в Visual Studio
## Общие сведения

Язык C++ позволяет использовать сторонние библиотеки, собранные в формате, понятном C++. 
Такие библиотеки должны содержать:
Заголовочные файлы ```.h``` или ```.hpp```, в которых содержатся сведения о доступных функциях и описания публичных структур данных и классов.
Файлы связывания или статические библиотеки ```.lib``` (или ```.a``` в Linux). В них содержатся реализации функций или данные для связывания с динамическими библиотеками. В первом случае, в исполняемый файл будут интегрированы инструкции из библиотеки, а во втором - будут содержаться ссылки на внешний файл (```.dll```) с инструкциями. Второй подход является более распространённым, поскольку уменьшает дублирование объёмных библиотек

## Подключение библиотек

Для подключения библиотек к проекту необходимо в явном виде указать компилятору, в каких каталогах располагаются требуемые файлы (.h, .hpp, .lib).

Общий алгоритм работы следующий:
1. Откройте свойства проекта
2. Перейдите во вкладку **Каталоги C++** 
3. Укажите путь до **Включаемые каталоги** (верхний каталог заголовочных файлов, обычно имеет имя include)
4. Укажите путь до **Каталоги библиотек** (верхний каталог lib-файлов. Обычно имеет имя lib, static и т.д.)
5. Перейдите во вкладку **Компоновщик - Ввод**
6. Укажите имена всех используемых ```.lib``` файлов. 
7. В проводнике перейдите в каталог динамических библиотек (обычно, bin)
8. Скопируйте требуемые ```.dll``` файлы в каталог к исполняемому файлу программы

Несколько важных моментов:
1. Библиотеки обычно поставляются в разных форматах под разные компиляторы, под разные разрядности, под разные режимы сборки (Debug/Release) обязательно проверяйте соответствие формата формату проекта. В противном случае программа может не скомпилироваться, либо вести себя непредсказуемо. ```.lib``` и ```.dll``` файлы обычно располагаются в соответствующих каталогах, либо имеют соответствующие приписки (например, opencv_world430d.lib - версия для режима Debug, а opencv_world430.lib - для Release). 

2. Компилятор не проверяет наличие ```.dll``` файлов в каталоге с приложением. Если файл отсутствует, Вы поймете это на этапе запуска и тестирования приложения.

3. Библиотеки ```.dll``` не обязательно располагать в одном каталоге с программой (особенно, когда они используются разных проектах). Динамические библиотеки могут располагаться в одном из каталогов переменных окружения (PATH). Добавить свой каталог можно при помощи следующей инструкции. Однако не советую добавлять все подряд каталоги в PATH. Это может вызывать конфликт 

## Библиотека Open CV
Библиотека Open CV предназначена для обработки изображений. Она позволяет читать и сохранять различные форматы изображений, а также применять различные фильтры и обработчики. Библиотека написана на языках C, C++, Asm, CUDA. Официальная поддержка имеется для C/C++, Python и Java.
На официальном сайте библиотеки https://opencv.org/releases/ можно загрузить как исходные кода библиотеки, так и уже скомпилированные версии под нужную ОС и компилятор. Сборка данной библиотеки занимает продолжительное время и требует определённых навыков, поэтому мы будем использовать уже собранную её версию. 
Рассмотрите содержимое архива. 


Используя инструкцию выше, подключите необходимые каталоги. Самостоятельно определите, какие версии библиотек требуются.

## Разработка первого приложения на OpenCV.

Рассмотрим простейший код, который откроет изображение, применит к нему некоторые обработки и сохранить результат в другой файл.

``` cpp
#include <opencv/core/core.hpp>

using namespace cv;

int main(){
Mat img = imread("путь к файлу");

imwrite(img, "путь к файлу");
return 0;
}
```

Скомпилируйте приложение и проверьте корректность его работы

## Разработка собственных библиотек в Visual Studio (C++)

Теперь рассмотрим вопрос того, а как сделать свою библиотеку? Библиотеки, разработанные на C++ и собранные в виде (.h/.lib/.dll) файлов доступны во многих языках программирования. Кроме того, отсутствие дополнительных прослоек в виде API, SDK и фреймворков делает C++ самым быстрым языком программирования в случае, когда речь идёт о рутинной обработке данных. 

Для создания библиотеки на C++ нам понадобится:
1. Создать пустой проект
2. Добавить 2 файла: MyLib.h и MyLib.cpp
3. В свойствах проекта выбрать тип приложения - "динамическая библиотека"
4. Проверить разрядность и режим сборки (Release x64)


Наша библиотека будет иметь 2 функции: сортировка массива "пузырьком" и сложение двух массивов чисел.

Реализации функций Вы, думаю, сможете сделать самостоятельно. Чтобы было легче делать описание, я приведу содержимое заголовочного файла


Обратите внимание на ```extern("C")``` данная конструкция требуется для того, чтобы при формировании библиотеки в файле DLL были указанные корректные имена функций в C-стиле. С таким подходом можно будет значительно удобнее использовать эти вызовы в других языках. Также в нашей библиотеки отсутствует точка входа, по той простой причине, что она не является исполняемым файлом (хотя она и может в нем присутствовать). При успешной сборке вы получите 3 файла:
.lib, .dll, .exp. В каталоге программы можно взять файл .h, это и будет наш заголовок, который позволит использовать описанные функции в других программах.

## Проверка библиотеки

Проверить возможности библиотеки и её зависимости можно при помощи утилиты Dumpbin. Чтобы ей воспользоваться найдите в меню Пуск Developer Command Prompt (x6).
В ней перейдите в каталог с ```.dll``` файлом (cd <имя каталога>) и выполните команду
```
cd path_to_your_bin_catalog
dumpbin.exe /exports MyLib.dll
```
В консоль будут выведены функции, доступные в библиотеке. А если вместо /exports напишите /imports, то сможете узнать, какие внешние зависимости использует ваша программа (там далеко не всегда всё однозначно)

### Использование библиотеки в других проектах

Используя инструкцию из первой части работы подключите библиотеку к новому проекту и проверьте корректность её работы. 

### Использование библиотеки в других языках программирования
