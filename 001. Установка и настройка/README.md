# С чего начать?

## Средства разработки
1. Netwide Assembler (NASM)
2. Microsoft Visual Studio (Пакет Разработка классических приложений на C++)


## Установка NASM
Для исследования принципов работы процессора мы будем использовать ассемблер NASM. Он поддерживает сборку под различные ОС и архитектуры, знает все современные инструкции и имеет достаточно простой синтаксис.
Загрузить его можно с официального сайта https://nasm.us/. Загружайте версию для Windows64 если ОС поддерживает инструкции x86-64. В противном случае x86-32. Инсталяционный пакет состоит из сборщика (NASM.EXE) и дизассемблера (NDISASM.EXE). 
На самом деле ассемблеры лишь переводят команды из человекочитаемого формата в машиночитаемый. Каждая команда имеет свой код (код операции). 
Каждый регистр имеет свой двоичный адрес. Именно эти команды и выполняет процессор, когда вы запускаете ОС, или же какую-либо программу в контексте ОС. 


## Немного о принципах исполнения кода 
После старта компьютера первой программой запускается BIOS. Она расположена на специальном ПЗУ, расположенном на материнской плате.
Это микропрограмма, задачей которой является проверка основных устройств, применение их настроек, построение порядка загрузки и копирование загрузочной программы в оперативную память. 
Загрузочная программа располагается в специальной области диска (её принято называть boot-сектор), и скрыта от глаз пользователя. 
Прочитать и записать её можно лишь специальными программами. А вот выполнить можно лишь в момент запуска компьютера, поскольку эта программа работает в особом, реальном режиме работы. 
О том, что это такое, мы рассмотрим в следующих работах, и даже попробуем написать подобные программы. 
А вот современным операционным системам недостаточно просто скопировать весь код из исполняемого файла в RAM и перейти к его исполнению. 
В ОС Windows/Linux исполняемые файлы должны придерживаться особой структуры, поэтому запустить код, сформированный через NASM не выйдет. 

 ![](https://img.shields.io/badge/Важно-red) *Мы работаем в контексте ОС Windows. Принцип работы программ в контексте Linux отличается. Несмотря на единую систему команд, отличия в структуре исполняемых файлов будут существенны.*. Также под Linux будет и другой компоновщик.

Для преобразования команд в требуемый ОС формат потребуется линковщик. Если Вы не используете внешние вызовы, сделать это можно даже вручную. Однако, для сложных проектов делать это вручную будет уже значительно сложнее.
Поэтому доверим эту задачу специальной программе - линковщику. Чтобы его запустить на ОС Windows потребуется скачать пакет и среду разработки Microsoft Visual Studio (Разработка классических приложений на C++).

## Режим отладки
Прежде, чем приступим к простейшим программам разберемся с тем, как в Visual Studio осуществляется отладка приложений на уровне машинных команд. 

1. Откройте Visual Studio. Если Visual Studio вместо основного окна предложит открыть проект, выберите пункт "Продолжить без кода"
2. Перейдите в меню "Файл" - "Открыть" - "Решение или проект" ![](https://img.shields.io/badge/Ctrl+Shift+O-blue)
3. Выберите любой исполняемый (.exe) файл, который хотите отладить
4. Перейдите в меню "Отладка" - "Шаг с заходом" ![](https://img.shields.io/badge/F11-blue)
5. Откройте необходимые окна:
6. "Отладка" - "Окна" - "Значения регистров процессора" ![](https://img.shields.io/badge/Ctrl+Alt+G-blue)
	   В окне "Регистры" выберите Флаги и ЦП
7. "Отладка" - "Окна" - "Дизассемблированный код" ![](https://img.shields.io/badge/Ctrl+Alt+D-blue)
8. "Отладка" - "Окна" - "Оперативная память" ![](https://img.shields.io/badge/Ctrl+Alt+M,%201-blue)

Теперь наша среда готова к отладке. Отладка программ в машинных кодах ничем не отличается от отладки программ C#/C++ в Visual Studio, только вместо программного кода - машинные команды, вместо переменных - регистры и RAM.
